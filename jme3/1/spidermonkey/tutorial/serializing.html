<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Serialization system :: jMonkeyEngine Documentation</title>
    <meta name="generator" content="Antora 2.3.0">
    <link rel="stylesheet" href="../../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../..">jMonkeyEngine Documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="jme3" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../documentation.html">Test</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../documentation.html">jMonkeyEngine 3</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Test</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Test</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../documentation.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../documentation.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../documentation.html">Test</a></li>
    <li><a href="serializing.html">Serialization system</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/davisro/dev/wikidemo-antora/docs/modules/ROOT/pages/spidermonkey/tutorial/serializing.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Serialization system</h1>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This article covers a deprecated <abbr title="Application Programming Interface">API</abbr>! See <a href="../../jme3/advanced/networking.html" class="page">networking</a> for current documentation.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this lesson you&#8217;ll learn about a pretty advanced system of SpiderMonkey. Why so early, you may ask; it&#8217;s because it is an important aspect of SpiderMonkey, that you need to understand to effectively network your games.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start with a general explanation of how the serialization system works. SpiderMonkey&#8217;s Serializer class is the entry point for everything serializing. Serializing is the act of translating an object into bytes, so it can be transferred over the network. SpiderMonkey does this by having Serializer classes (they extend Serializer itself), and having some static methods available in the Serializer class. A serializer does not exist without a class it can serialize - this means that Serializers need to be registered with a class. For example, the String type is registered to the StringSerializer class. Without the String type being registered, there&#8217;d be no instance of StringSerializer. So! Let&#8217;s get down to business!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_writing_your_own_serializer"><a class="anchor" href="#_writing_your_own_serializer"></a>Writing your own serializer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There is going to be a situation where you need to serialize something yourself, whether you like it or not. We&#8217;re going through how you&#8217;re going to do, by writing a entirely new Serializer - please note that this Serializer is not necessary in SpiderMonkey, since SpiderMonkey can serialize Serializable, and InetAddress4 implements Serializable (though it does save a LOT of bytes by doing it yourself). The field that makes an InetAddress4 an InetAddress4 is the IP address, so that&#8217;s what we&#8217;re going to serialize. Let&#8217;s start by going through the basics of extending the Serializer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Inet4AddressSerializer extends Serializer {
   public InetAddress readObject(ByteBuffer data, Class c) throws IOException
      return null;
   }

   public void writeObject(ByteBuffer buffer, Object object) throws IOException {
      InetAddress address = (InetAddress)object;
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, you have to extend Serializer and implement the methods T readObject(ByteBuffer, Class) and writeObject(ByteBuffer, Object). These are the methods that actually do the job. Obviously, writeObject is used when sending, and readObject is used when reading. The next part is just Java coding - you just kind of have to know the <abbr title="Application Programming Interface">API</abbr> of those objects you&#8217;re serializing to convert into bytes. This one&#8217;s really simple though ;)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Inet4AddressSerializer extends Serializer {
   @Override
   public &lt;T&gt; T readObject(ByteBuffer data, Class&lt;T&gt; c) throws IOException {
       byte[] address = new byte[4];
       data.get(address);
       return (T)Inet4Address.getByAddress(address);
   }

   @Override
   public void writeObject(ByteBuffer buffer, Object object) throws IOException {
       Inet4Address address = (Inet4Address)object;
       buffer.put(address.getAddress());
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>So now you&#8217;ve got this serializer, and you don&#8217;t know what to do with it. Well, you need to register it to a class, and what other class would you want to register it to, than Inet4Address?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Serializer.registerClass(Inet4Address.class, new Inet4AddressSerializer());</code></pre>
</div>
</div>
<div class="paragraph">
<p>And now you can use the Inet4Address anywhere in a Message! Now we&#8217;ll test this Serializer, and see if we can get the IP on the other side:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class AddressMessage extends Message {
  public Inet4Address addr;
  public AddressMessage(Inet4Address addr) { this.addr = addr; }
}
...
client.send(new AddressMessage(Inet4Address.getByName("google.com")));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Results in a message being received, which prints out as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>/66.102.13.106</code></pre>
</div>
</div>
<div class="paragraph">
<p>And there you go, that&#8217;s the end of this tutorial!</p>
</div>
<div class="paragraph">
<p>Next tutorial you&#8217;ll learn about a simple, but powerful feature - compression.</p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
