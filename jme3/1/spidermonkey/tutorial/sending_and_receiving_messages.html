<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Sending and receiving messages :: jMonkeyEngine Documentation</title>
    <link rel="canonical" href="https://8keep.github.io/wikidemo-antora/jme3/1/spidermonkey/tutorial/sending_and_receiving_messages.html">
    <meta name="generator" content="Antora 2.3.0">
    <link rel="stylesheet" href="../../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://8keep.github.io/wikidemo-antora">jMonkeyEngine Documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="jme3" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../documentation.html">Test</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../documentation.html">jMonkeyEngine 3</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Test</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Test</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../documentation.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../documentation.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../documentation.html">Test</a></li>
    <li><a href="sending_and_receiving_messages.html">Sending and receiving messages</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/8Keep/wikidemo-antora/edit/master/docs/modules/ROOT/pages/spidermonkey/tutorial/sending_and_receiving_messages.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Sending and receiving messages</h1>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This article covers a deprecated <abbr title="Application Programming Interface">API</abbr>! See <a href="../../jme3/advanced/networking.html" class="page">networking</a> for current documentation.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this tutorial I&#8217;m going to cover sending and receiving messages. I&#8217;ll also explain how to write your own messages. This tutorial assumes you already have a working server-client connection.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start by creating our own message. Later on we&#8217;ll send this across the network.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Serializable()
public class HelloMessage extends Message {
   public String hello = "Hello!";
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is probably the smallest and simplest message you&#8217;ll find. This is simply the process of creating a class, extending Message, and adding your fields to it. Also you need the @Serializable annotation, but we&#8217;ll get to that later. Even though you don&#8217;t <strong>have to</strong> extend Message, you generally should since then SpiderMonkey can add client and connection information on receiving. You can also send separate data, but we&#8217;ll not go into that here - you should just send Messages.</p>
</div>
<div class="paragraph">
<p>Now let&#8217;s send this message across the network. We&#8217;ll send it from the client to the server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Serializer.registerClass(HelloMessage.class);
server.addMessageListener(this, HelloMessage.class);
client.addMessageListener(this, HelloMessage.class);
client.send(new HelloMessage());</code></pre>
</div>
</div>
<div class="paragraph">
<p>First we&#8217;ve registered the class to the Serializer. This needs to happen on both the client and server, I&#8217;ll explain why in the next tutorial. Then we add the message listeners for both the server and client, this makes sure we&#8217;re notified when messages are received. Then we send the message. The message is by default reliable, and so it will be sent over TCP. Now we&#8217;ll handle it on the server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public void messageReceived(Message message) {
   // This message is of type HelloMessage, so we don't have to check.
   HelloMessage helloMessage = (HelloMessage)message;
   System.out.println(helloMessage.hello);
   helloMessage.hello = "Hi!";
   message.getClient().send(helloMessage);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This simply receives the message, and changes the Hello! to Hi! and sends it back to the client. The client, can of course handle this message however it wants to.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_serializable_annotation"><a class="anchor" href="#_serializable_annotation"></a>Serializable annotation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Serializable annotation is used to determine which serializer you want to use for your message, and which ID you want to register to it. If you specify no ID and no serializer, a ID will be assigned, and the default serializer will be used. The problem with specifying no ID is that you have to have the same order of registration on both the client and server, otherwise serializing will go wrong. It&#8217;s therefore advisable that you use the id field, if you want to register classes in a different order.</p>
</div>
<div class="paragraph">
<p>The default serializer is, of course, FieldSerializer, which&#8217;ll do just fine for just about any message you can throw at it. However, if you wish to serialize your message yourself, all you must do is write your own serializer, and then pass the class to the serializer field in the annotation. For example, this Serializable annotation sets ID to four, and serializer to CustomSerializer (which doesn&#8217;t exist, mind you).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Serializable(id=4, serializer=CustomSerializer.class)</code></pre>
</div>
</div>
<div class="paragraph">
<p>That was it! The next tutorial explains how the Serializer system works, and how you can register your own serializers!</p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
