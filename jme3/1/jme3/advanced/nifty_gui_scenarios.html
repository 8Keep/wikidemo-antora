<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nifty GUI 1.4.2 - Usecase Scenarios :: jMonkeyEngine Documentation</title>
    <link rel="canonical" href="https://8keep.github.io/wikidemo-antora/jme3/1/jme3/advanced/nifty_gui_scenarios.html">
    <meta name="keywords" content="gui, documentation, nifty, hud, click, state, states, sound, effect">
    <meta name="generator" content="Antora 2.3.0">
    <link rel="stylesheet" href="../../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://8keep.github.io/wikidemo-antora">jMonkeyEngine Documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="jme3" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../documentation.html">Test</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../documentation.html">jMonkeyEngine 3</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Test</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Test</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../documentation.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../documentation.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../documentation.html">Test</a></li>
    <li><a href="nifty_gui_scenarios.html">Nifty GUI 1.4.2 - Usecase Scenarios</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/davisro/dev/wikidemo-antora/docs/modules/ROOT/pages/jme3/advanced/nifty_gui_scenarios.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Nifty GUI 1.4.2 - Usecase Scenarios</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This document contains typical NiftyGUI usecase scenarios, such as adding effects, game states, and creating typical game screens.</p>
</div>
<div class="paragraph">
<p>Requirements: These tips assume that you have read and understood the <a href="nifty_gui.html" class="page">Creating JME3 User Interfaces with Nifty GUI</a> tutorial, and have already laid out a basic <abbr title="Graphical User Interface">GUI</abbr> that interacts with your JME3 application. Here you learn how you integrate the <abbr title="Graphical User Interface">GUI</abbr> better, and add effects and advanced controls.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_switch_game_states"><a class="anchor" href="#_switch_game_states"></a>Switch Game States</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In a JME game, you typically have three game states:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Stopped: The game is stopped, a StartScreen is displayed.</p>
</li>
<li>
<p>Running: The game is running, the in-game HudScreen is displayed.</p>
</li>
<li>
<p>Paused: The game is paused, a PausedScreen is displayed.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>(Aside: Additionally, the Stopped state often contains a LoadScreen, LogonScreen, OptionsScreen, CharacterCreationScreen, HighScoreScreen, CreditsScreen, etc. Some games let you access the OptionsScreen in the Paused state as well. The Running state can also contain an InventoryScreen, ItemShopScreen, StatsScreen, SkillScreen, etc.)</p>
</div>
<div class="paragraph">
<p>In JME, game states are implemented as custom <a href="application_states.html" class="page">AppState</a> objects. Write each AppState so it brings its own input mappings, rootNode content, update loop behaviour, etc with it.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Stopped: StartScreen AppState + GuiInputs AppState</p>
</li>
<li>
<p>Paused: PausedScreen AppState + GuiInputs AppState</p>
</li>
<li>
<p>Running: HudScreen AppState + InGameInputs AppState + BulletAppState (jme physics), …</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When the player switches between game states, you detach one set of AppStates, and attach another. For example, when the player pauses the running game, you use a boolean switch to pause the game loop and deactivate the game inputs (shooting, navigation). The screen is overlayed with a PausedScreen, which contains a visible mouse pointer and a Continue button. When the player clicks Continue, the mouse pointer is deactivated, the in-game input and navigational mappings are activated, and the game loop continues.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_get_access_to_application_and_update_loop"><a class="anchor" href="#_get_access_to_application_and_update_loop"></a>Get Access to Application and Update Loop</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Since you are writing a jME3 application, you can additionally make any ScreenController class extend the <a href="application_states.html" class="page">BaseAppState</a> class.
This gives the ScreenController access to the application object and to the update loop!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class StartScreenState extends BaseAppState implements ScreenController {

    private Node localRootNode = new Node("Start Screen RootNode");
    private Node localGuiNode = new Node("Start Screen GuiNode");
    private final ColorRGBA backgroundColor = ColorRGBA.Gray;

    @Override
    protected void initialize(Application app) {
        //It is technically safe to do all initialization and cleanup in the
        //onEnable()/onDisable() methods. Choosing to use initialize() and
        //cleanup() for this is a matter of performance specifics for the
        //implementor.
        //TODO: initialize your AppState, e.g. attach spatials to rootNode
        ((SimpleApplication) app).getRootNode().attachChild(localRootNode);
        ((SimpleApplication) app).getGuiNode().attachChild(localGuiNode);
        ((SimpleApplication) app).getViewPort().setBackgroundColor(backgroundColor);

        /** init the screen */
    }

    @Override
    protected void cleanup(Application app) {
        //TODO: clean up what you initialized in the initialize method,
        //e.g. remove all spatials from rootNode
        ((SimpleApplication) app).getRootNode().detachChild(localRootNode);
        ((SimpleApplication) app).getGuiNode().detachChild(localGuiNode);
    }

    //onEnable()/onDisable() can be used for managing things that should
    //only exist while the state is enabled. Prime examples would be scene
    //graph attachment or input listener attachment.
    @Override
    protected void onEnable() {
        //Called when the state is fully enabled, ie: is attached and
        //isEnabled() is true or when the setEnabled() status changes after the
        //state is attached.
    }

    @Override
    protected void onDisable() {
        //Called when the state was previously enabled but is now disabled
        //either because setEnabled(false) was called or the state is being
        //cleaned up.
    }

    @Override
    public void update(float tpf) {
        //TODO: implement behavior during runtime
    }

    @Override
    public void bind(Nifty nifty, Screen screen) {
    }

    @Override
    public void onStartScreen() {
    }

    @Override
    public void onEndScreen() {
    }

}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is not sufficient to just inherit from BaseAppState. You need to instantiate your controller class, register it with app&#8217;s stateManager and then pass it to nifty. Remember, to connect a screen with a ScreenController you still need to specify the fully qualified class name of
your ScreenController in the controller attribute of the &lt;screen&gt; tag in the xml file. See code sample below.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">XML example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class TestNiftyGui extends SimpleApplication {
  public void simpleInitApp() {
     StartScreenState startScreenState = new StartScreenState();
     stateManager.attach(startScreenState);
     // [...] boilerplate init nifty omitted
     nifty.fromXml("Interface/myGui.xml", "start", startScreenState); //one of the XML screen elements needs to reference StartScreenState controller class
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_know_your_variables"><a class="anchor" href="#_know_your_variables"></a>Know Your Variables</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>${CALL.myMethod()}</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Calls a method in the current ScreenController and gets the method&#8217;s return String. The method can also be void and have a side effect, e.g. play a sound etc.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>${ENV.HOME}</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Returns the path to user&#8217;s home directory.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>${ENV.key}</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Looks up <code>key</code> in the environment variables. Use it like Java&#8217;s System.getEnv(“key).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>${PROP.key}</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>looks up <code>key</code> in the Nifty properties. Use Nifty.setGlobalproperties(properties) and Nifty.getGlobalproperties(“key). Or SystemGetProperties(key);</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>See also: <a href="https://github.com/nifty-gui/nifty-gui/raw/1.4/nifty-core/manual/nifty-gui-the-manual-1.3.2.pdf">Nifty GUI - the Manual: XML GUI (Special XML Markup)</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_use_screencontrollers_for_mutally_exclusive_functionality"><a class="anchor" href="#_use_screencontrollers_for_mutally_exclusive_functionality"></a>Use ScreenControllers for Mutally Exclusive Functionality</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Technically you are free to create one ScreenController class for each screen, or reuse the same ScreenController for all or some of them. In the end it may be best to create individual ScreenControllers for functionality that is mutually exclusive.</p>
</div>
<div class="paragraph">
<p>For example, create a <code>MyHudScreen.java</code> for the <code>hud</code> screen, and a <code>MyStartScreen.java</code> for the <code>start</code> screen.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Include all user interface methods that are needed during the game (while the HUD is up) in <code>MyHudScreen.java</code>. Then make this class control all screens that can be up during the game (the HUD screen, a MiniMap screen, an Inventory screen, an Abilities or Skills screen, etc). All these screens possibly share data (game data, player data), so it makes sense to control them all with methods of the same <code>MyHudScreen.java</code> class.</p>
</li>
<li>
<p>The start screen, however, is mostly independent of the running game. Include all user interface methods that are needed outside the game (while you are on the start screen) in <code>MyStartScreen.java</code>. Then make this class control all screens that can be up outside the game (the Start screen, a Settings/Options screen, a HighScore screen, etc). All these classes need to read and write saved game data, so it makes sense to control them all with methods of the same <code>MyStartScreen.java</code> class.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_a_loading_screen"><a class="anchor" href="#_create_a_loading_screen"></a>Create a "Loading&#8230;&#8203;" Screen</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Get the full <a href="loading_screen.html" class="page">Loading Screen</a> tutorial here.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_a_popup_menu"><a class="anchor" href="#_create_a_popup_menu"></a>Create a Popup Menu</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Get the full <a href="nifty_gui_popup_menu.html" class="page">Nifty GUI PopUp Menu</a> tutorial here.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_add_visual_effects"><a class="anchor" href="#_add_visual_effects"></a>Add Visual Effects</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can register effects to screen elements.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Respond to element events such as onStartScreen, onEndScreen, onHover, onFocus, onActive,</p>
</li>
<li>
<p>Trigger effects that change movement, blending, size, color, fading, and much more.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is an example that moves a panel when the startScreen opens. You place an &lt; effect &gt; tag inside the element that you want to  be affected.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;panel height="25%" width="35%" ...&gt;
  &lt;effect&gt;
    &lt;onStartScreen name="move" mode="in" direction="top" length="300" startDelay="0" inherit="true"/&gt;
  &lt;/effect&gt;
&lt;/panel&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Learn more from the NiftyGUI page:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/nifty-gui/nifty-gui/raw/1.4/nifty-core/manual/nifty-gui-the-manual-1.3.2.pdf">Nifty GUI - the Manual: Effects</a></p>
</li>
<li>
<p><a href="https://github.com/nifty-gui/nifty-gui/wiki/Effects">Effects</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_add_sound_effects"><a class="anchor" href="#_add_sound_effects"></a>Add Sound Effects</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Playing sounds using Nifty is also possible with a <code>playSound</code> effect as trigger. Remember to first register the sound that you want to play:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;registerSound id="myclick" filename="Interface/sounds/ButtonClick.ogg" /&gt;
...
&lt;label&gt;
  &lt;effect&gt;
    &lt;onClick name="playSound" sound="myclick"/&gt;
  &lt;/effect&gt;
&lt;/label&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pass_clickloc_from_nifty_to_java"><a class="anchor" href="#_pass_clickloc_from_nifty_to_java"></a>Pass ClickLoc From Nifty to Java</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After a mouse click, you may want to record the 2D clickLoc and send this info to your Java application. Typical ScreenController methods however only have a String argument. You&#8217;d have to convert the String to ints.</p>
</div>
<div class="paragraph">
<p>To pass the clickLoc as two ints, you can use the special <code>(int x, int y)</code> syntax in the ScreenController:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  public void clicked(int x, int y) {
    // here you can use the x and y of the clickLoc
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the Nifty <abbr title="Graphical User Interface">GUI</abbr> screen code (e.g. XML file) you must call the <code>(int x, int y)</code> method <em>without</em> any parameters!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;interact onClick="clicked()"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can name the method (here <code>clicked</code>) what ever you like, as long as you keep the argument syntax.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_load_several_xml_files"><a class="anchor" href="#_load_several_xml_files"></a>Load Several XML Files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The basic Nifty <abbr title="Graphical User Interface">GUI</abbr> example showed how to use the <code>nifty.fromXML()</code> method to load one XML file containing all Nifty <abbr title="Graphical User Interface">GUI</abbr> screens.
The following code sample shows how you can load several XML files into one nifty object. Loading several files with <code>nifty.addXml()</code> allows you to split up each screen into one XML file, instead of all into one hard-to-read XML file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">NiftyJmeDisplay niftyDisplay = new NiftyJmeDisplay(assetManager, inputManager, audioRenderer, viewPort);
Nifty nifty = niftyDisplay.getNifty();
nifty.addXml("Interface/Screens/OptionsScreen.xml");
nifty.addXml("Interface/Screens/StartScreen.xml");
nifty.gotoScreen("startScreen");
StartScreenControl screenControl = (StartScreenControl) nifty.getScreen("startScreen").getScreenController();
OptionsScreenControl optionsControl = (OptionsScreenControl) nifty.getScreen("optionsScreen").getScreenController();
stateManager.attach(screenControl);
stateManager.attach(optionsControl);
guiViewPort.addProcessor(niftyDisplay);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_register_additional_explicit_screen_controllers"><a class="anchor" href="#_register_additional_explicit_screen_controllers"></a>Register additional explicit screen controllers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In addition to the <code>nifty.addXml()</code> methods to attach many nifty XML files, there exists a <code>nifty.registerScreenController()</code> method to explicitly attach more screen controllers.</p>
</div>
<div class="paragraph">
<p>The following code sample shows how you can explicitly attach several screen controllers before adding the XML file to nifty, which would otherwise cause nifty to implicitly instantiate the screen controller class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">NiftyJmeDisplay niftyDisplay = NiftyJmeDisplay.newNiftyJmeDisplay(assetManager, inputManager, audioRenderer, viewPort);
Nifty nifty = niftyDisplay.getNifty();

nifty.registerScreenController(new OptionsScreenController(randomConstructorArgument));
nifty.addXml("Interface/Screens/OptionsScreen.xml");</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_design_your_own_styles"><a class="anchor" href="#_design_your_own_styles"></a>Design Your Own Styles</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, your Nifty XML screens use the built.in styles:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml"> &lt;useStyles filename="nifty-default-styles.xml" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>But you can switch to a set of custom styles in your game project&#8217;s asset directory like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml"> &lt;useStyles filename="Interface/Styles/myCustomStyles.xml" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Inside myCustomStyles.xml you define styles like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;nifty-styles&gt;
  &lt;useStyles filename="Interface/Styles/Font/myCustomFontStyle.xml" /&gt;
  &lt;useStyles filename="Interface/Styles/Button/myCustomButtonStyle.xml" /&gt;
  &lt;useStyles filename="Interface/Styles/Label/myCustomLabelStyle.xml" /&gt;
  ...
&lt;/nifty-styles&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Learn more about how to create styles by looking at the <a href="https://github.com/nifty-gui/nifty-gui/wiki/Working-from-Source">Nifty GUI source code</a> for “nifty-style-black”. Copy it as a template and change it to create your own style.</p>
</div>
<hr>
<div class="paragraph">
<p>Learn more from the NiftyGUI page:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/nifty-gui/nifty-gui/wiki/Effects">https://github.com/nifty-gui/nifty-gui/wiki/Effects</a></p>
</li>
</ul>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
